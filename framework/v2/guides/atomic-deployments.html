<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Atomic deployments | 0xcert Docs</title>
    <meta name="description" content="Leverage the most advanced open-source framework to create, manage and swap digital assets (ERC-721) and value tokens (ERC-20) on the blockchain.">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.d7956b4c.css" as="style"><link rel="preload" href="/assets/js/app.beb59d9e.js" as="script"><link rel="preload" href="/assets/js/2.f199345b.js" as="script"><link rel="preload" href="/assets/js/7.ac8cad6a.js" as="script"><link rel="preload" href="/assets/js/61.f0466c96.js" as="script"><link rel="preload" href="/assets/js/5.36f6fd2c.js" as="script"><link rel="prefetch" href="/assets/js/10.c66955e5.js"><link rel="prefetch" href="/assets/js/11.55341847.js"><link rel="prefetch" href="/assets/js/12.ce9bef93.js"><link rel="prefetch" href="/assets/js/13.fb7313b2.js"><link rel="prefetch" href="/assets/js/14.75e0fe85.js"><link rel="prefetch" href="/assets/js/15.b74cb165.js"><link rel="prefetch" href="/assets/js/16.e9d2426e.js"><link rel="prefetch" href="/assets/js/17.a7459db7.js"><link rel="prefetch" href="/assets/js/18.811d9380.js"><link rel="prefetch" href="/assets/js/19.364ff44b.js"><link rel="prefetch" href="/assets/js/20.ab90b2b5.js"><link rel="prefetch" href="/assets/js/21.dd4c139a.js"><link rel="prefetch" href="/assets/js/22.cac6d59f.js"><link rel="prefetch" href="/assets/js/23.9f964b50.js"><link rel="prefetch" href="/assets/js/24.dff646fb.js"><link rel="prefetch" href="/assets/js/25.c760f19f.js"><link rel="prefetch" href="/assets/js/26.3d9562ab.js"><link rel="prefetch" href="/assets/js/27.4f0b9081.js"><link rel="prefetch" href="/assets/js/28.dcd67674.js"><link rel="prefetch" href="/assets/js/29.174568a7.js"><link rel="prefetch" href="/assets/js/3.4f6b0ef7.js"><link rel="prefetch" href="/assets/js/30.7175d751.js"><link rel="prefetch" href="/assets/js/31.1790c975.js"><link rel="prefetch" href="/assets/js/32.a70de6ce.js"><link rel="prefetch" href="/assets/js/33.436b2dec.js"><link rel="prefetch" href="/assets/js/34.a753fcd3.js"><link rel="prefetch" href="/assets/js/35.56cdf595.js"><link rel="prefetch" href="/assets/js/36.a2b4312b.js"><link rel="prefetch" href="/assets/js/37.a2aa47e7.js"><link rel="prefetch" href="/assets/js/38.97e4f0d4.js"><link rel="prefetch" href="/assets/js/39.27a56882.js"><link rel="prefetch" href="/assets/js/4.737f5e48.js"><link rel="prefetch" href="/assets/js/40.96a70146.js"><link rel="prefetch" href="/assets/js/41.edb3cc79.js"><link rel="prefetch" href="/assets/js/42.0ff844dd.js"><link rel="prefetch" href="/assets/js/43.04f1eefc.js"><link rel="prefetch" href="/assets/js/44.4820b37b.js"><link rel="prefetch" href="/assets/js/45.baca3d5d.js"><link rel="prefetch" href="/assets/js/46.1c3ae08a.js"><link rel="prefetch" href="/assets/js/47.3a3ee223.js"><link rel="prefetch" href="/assets/js/48.59696877.js"><link rel="prefetch" href="/assets/js/49.71759e03.js"><link rel="prefetch" href="/assets/js/50.6cdd92e1.js"><link rel="prefetch" href="/assets/js/51.8fe14ed7.js"><link rel="prefetch" href="/assets/js/52.e95386ab.js"><link rel="prefetch" href="/assets/js/53.5e2d4e2e.js"><link rel="prefetch" href="/assets/js/54.269247c8.js"><link rel="prefetch" href="/assets/js/55.014d05cd.js"><link rel="prefetch" href="/assets/js/56.b556e10d.js"><link rel="prefetch" href="/assets/js/57.b48fe0f3.js"><link rel="prefetch" href="/assets/js/58.44fb3f5b.js"><link rel="prefetch" href="/assets/js/59.7d0a324f.js"><link rel="prefetch" href="/assets/js/6.6e3b4cb8.js"><link rel="prefetch" href="/assets/js/60.aa807d25.js"><link rel="prefetch" href="/assets/js/62.b43822ad.js"><link rel="prefetch" href="/assets/js/63.7d791beb.js"><link rel="prefetch" href="/assets/js/64.48e9cc98.js"><link rel="prefetch" href="/assets/js/65.c9709bc2.js"><link rel="prefetch" href="/assets/js/66.fc44a20b.js"><link rel="prefetch" href="/assets/js/67.4aeb1f1a.js"><link rel="prefetch" href="/assets/js/68.37bcef0a.js"><link rel="prefetch" href="/assets/js/69.e3d69270.js"><link rel="prefetch" href="/assets/js/70.5efa6433.js"><link rel="prefetch" href="/assets/js/71.0740b18c.js"><link rel="prefetch" href="/assets/js/72.8a12cec4.js"><link rel="prefetch" href="/assets/js/73.e0eb7500.js"><link rel="prefetch" href="/assets/js/74.26c13b61.js"><link rel="prefetch" href="/assets/js/75.2319e331.js"><link rel="prefetch" href="/assets/js/76.ac15d63e.js"><link rel="prefetch" href="/assets/js/77.a338de77.js"><link rel="prefetch" href="/assets/js/78.c7b994ac.js"><link rel="prefetch" href="/assets/js/79.06acbcc7.js"><link rel="prefetch" href="/assets/js/8.ece7f58f.js"><link rel="prefetch" href="/assets/js/9.feeb36fc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d7956b4c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/0xcert-logo.svg" alt="0xcert Docs" class="logo"> <span class="site-name can-hide">0xcert Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/framework/v2/" class="nav-link router-link-active">
  Framework
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  0xcert API
</a></div><div class="nav-item"><a href="https://0xcert.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/0xcert/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/framework/v2/" class="nav-link router-link-active">
  Framework
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  0xcert API
</a></div><div class="nav-item"><a href="https://0xcert.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/0xcert/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introduction</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/v2/introduction/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/framework/v2/introduction/non-fungible-assets.html" class="sidebar-link">Non-fungible assets</a></li><li><a href="/framework/v2/introduction/fungible-values.html" class="sidebar-link">Fungible values</a></li><li><a href="/framework/v2/introduction/0xcert-tokens.html" class="sidebar-link">0xcert tokens</a></li><li><a href="/framework/v2/introduction/atomic-transactions.html" class="sidebar-link">Atomic transactions</a></li><li><a href="/framework/v2/introduction/interoperability.html" class="sidebar-link">Interoperability</a></li><li><a href="/framework/v2/introduction/authenticity.html" class="sidebar-link">Authenticity</a></li><li><a href="/framework/v2/introduction/threat-models.html" class="sidebar-link">Threat models</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guides</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/v2/guides/certification.html" class="sidebar-link">Certification</a></li><li><a href="/framework/v2/guides/communication.html" class="sidebar-link">Communication</a></li><li><a href="/framework/v2/guides/providers.html" class="sidebar-link">Providers</a></li><li><a href="/framework/v2/guides/asset-management.html" class="sidebar-link">Asset management</a></li><li><a href="/framework/v2/guides/value-management.html" class="sidebar-link">Value management</a></li><li><a href="/framework/v2/guides/atomic-deployments.html" class="active sidebar-link">Atomic deployments</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/v2/guides/atomic-deployments.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/framework/v2/guides/atomic-deployments.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/framework/v2/guides/atomic-deployments.html#initialization" class="sidebar-link">Initialization</a></li><li class="sidebar-sub-header"><a href="/framework/v2/guides/atomic-deployments.html#asset-ledger-deploy-order" class="sidebar-link">Asset ledger deploy order</a></li><li class="sidebar-sub-header"><a href="/framework/v2/guides/atomic-deployments.html#value-ledger-deploy-order" class="sidebar-link">Value ledger deploy order</a></li></ul></li><li><a href="/framework/v2/guides/atomic-actions.html" class="sidebar-link">Atomic actions</a></li><li><a href="/framework/v2/guides/atomic-approval.html" class="sidebar-link">Atomic approval</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API References</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/v2/api/certification.html" class="sidebar-link">Certification</a></li><li><a href="/framework/v2/api/ethereum-connectors.html" class="sidebar-link">Ethereum connectors</a></li><li><a href="/framework/v2/api/wanchain-connectors.html" class="sidebar-link">Wanchain connectors</a></li><li><a href="/framework/v2/api/vuejs-plugin.html" class="sidebar-link">Vue.js Plugin</a></li></ul></section></li></ul>  <div class="footer"><img src="/0xcert-framework.svg" alt> <p>The 0xcert Framework is a platform that provides a complete set of tools for building powerful decentralized applications (dapps). <br>Feel free to <a href="https://github.com/0xcert/framework/blob/master/CONTRIBUTING.md" target="_blank">contribute.</a></p></div></aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="atomic-deployments"><a href="#atomic-deployments" class="header-anchor">#</a> Atomic deployments</h1> <p>The main purpose of atomic deployments is to delegate ETH execution to a third party enabling ETH-less transactions.</p> <p>So the difference between doing a normal <code>AssetLedger</code>/<code>ValueLedger</code> deploy is that in an atomic deploy you specify what kind of ledger you are creating (same as doing a normal deploy), as well as the receiver of a value transaction (fee), and who can execute the order (can be set to a direct address or anyone). This enables deployment in a fashion that the user defines deploy order and value transfer of some token, and anyone willing to execute the deployment for the value fee can do it.</p> <p>Atomic deployment, like atomic order, is created through the <code>Gateway</code>, which, as its name suggests, is the gateway to the 0xcert protocol smart contract, deployed on the network and enabling atomic operations.</p> <p>Let's check out an example of both atomic deployments.</p> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <p>In this guide, we will assume you have gone through the <a href="/framework/v2/api/value-management.html">Value Management</a> guide and have a <code>ValueLedger</code> deployed. You will also need two MetaMask accounts (create them through your MetaMask plug-in) with some ETH available.</p> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <p>We recommend you employ the package as an NPM package in your application.</p> <div class="language-ell extra-class"><pre class="language-text"><code>$ npm i --save @0xcert/ethereum-gateway
</code></pre></div><p>In our official <a href="https://github.com/0xcert/framework" target="_self" rel="noopener noreferrer alternate">GitHub repository</a>, we also host a compiled and minimized JavaScript file that can be directly implemented in your website. Please refer to the <a href="/api/core.html">API</a> section to learn more about gateway.</p> <h2 id="initialization"><a href="#initialization" class="header-anchor">#</a> Initialization</h2> <p>As usual, we first import a module into the application. This time, we import the <code>Gateway</code> class, which represents a wrapper around a specific pre-deployed structure on the Ethereum network.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Gateway <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@0xcert/ethereum-gateway'</span><span class="token punctuation">;</span>
</code></pre></div><p>Then, we create a new instance of the <code>Gateway</code> class with an ID that points to a pre-deployed gateway on the Ethereum Ropsten network (this option can also be configured in the provider).</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> gateway <span class="token operator">=</span> Gateway<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>provider<span class="token punctuation">,</span> <span class="token function">buildGatewayConfig</span><span class="token punctuation">(</span>NetworkKind<span class="token punctuation">.</span><span class="token constant">ROPSTEN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>buildGatewayConfig</code> will always return the latest contract versions for a specific package version. If you want to configure gateway config on your own, you can find our already deployed addresses <a href="/framework/v2/api/ethereum-connectors.html#public-addresses">here</a>.</p> <h2 id="asset-ledger-deploy-order"><a href="#asset-ledger-deploy-order" class="header-anchor">#</a> Asset ledger deploy order</h2> <div class="card custom-block"><p class="custom-block-title">Live example</p> <p>Click <a href="https://codesandbox.io/s/github/0xcert/example-asset-ledger-deploy-order?module=%2FREADME.md" target="_self" rel="noopener noreferrer alternate">here</a> to check the live example for the asset ledger deploy order.</p></div> <p>We always have two participants in a deploy order. The first is the maker of the order, the one who defines what will happen. The second one is the taker, who can either be directly specified or left empty to be filled by anyone who can execute the order. Our example will take the second option. So let's jump right in and define a deploy order.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> order <span class="token operator">=</span> <span class="token punctuation">{</span>
  kind<span class="token operator">:</span> OrderKind<span class="token punctuation">.</span><span class="token constant">ASSET_LEDGER_DEPLOY_ORDER</span><span class="token punctuation">,</span>
  makerId<span class="token operator">:</span> <span class="token string">'0x...'</span><span class="token punctuation">,</span> <span class="token comment">// account1 defining the order</span>
  seed<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// unique order identification</span>
  expiration<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">86400000</span><span class="token punctuation">,</span> <span class="token comment">// 1 day</span>
  assetLedgerData<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token comment">// ledger name</span>
    <span class="token builtin">symbol</span><span class="token operator">:</span> <span class="token string">&quot;TST&quot;</span><span class="token punctuation">,</span> <span class="token comment">// ledger symbol</span>
    uriPrefix<span class="token operator">:</span> <span class="token string">&quot;https://base.com/&quot;</span><span class="token punctuation">,</span> <span class="token comment">// uri template prefix</span>
    uriPostfix<span class="token operator">:</span> <span class="token string">&quot;.json&quot;</span><span class="token punctuation">,</span> <span class="token comment">// uri template prefix</span>
    schemaId<span class="token operator">:</span> <span class="token string">&quot;9c22ff5f21f0b81b113e63f7db6da94fedef11b2119b4088b89664fb9a3cb658&quot;</span><span class="token punctuation">,</span> <span class="token comment">// schemaId calculated through the certification guide</span>
    capabilities<span class="token operator">:</span> <span class="token punctuation">[</span>
      AssetLedgerCapability<span class="token punctuation">.</span><span class="token constant">TOGGLE_TRANSFERS</span><span class="token punctuation">,</span>
      AssetLedgerCapability<span class="token punctuation">.</span><span class="token constant">DESTROY_ASSET</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    ownerId<span class="token operator">:</span> <span class="token string">'0x...'</span><span class="token punctuation">,</span> <span class="token comment">// account1 which will get all abilities for this ledger</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  tokenTransferData<span class="token operator">:</span> <span class="token punctuation">{</span>
    ledgerId<span class="token operator">:</span> <span class="token string">'0x..'</span><span class="token punctuation">,</span> <span class="token comment">// valueLedgerId that we created in the previous guide</span>
    value<span class="token operator">:</span> <span class="token string">&quot;100000000000000000000&quot;</span> <span class="token comment">// 100 tokens</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">as</span> AssetLedgerDeployOrder<span class="token punctuation">;</span>
</code></pre></div><p>Since we are transferring some value, we also have to approve the <code>Gateway</code> for transferring it. We do this by calling approveValue upon the <code>ValueLedger</code> instance of the ledger we are transferring tokens from. We also need to specify the amount of value we are approving for transfer.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If we approve a huge amount of value (max is 2^256-1), we only need to approve it once per ledger, otherwise, we would run out of allowance.</p></div> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> transferProxy <span class="token operator">=</span> <span class="token keyword">await</span> gateway<span class="token punctuation">.</span><span class="token function">getProxyAccountId</span><span class="token punctuation">(</span>ProxyKind<span class="token punctuation">.</span><span class="token constant">TRANSFER_TOKEN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mutation <span class="token operator">=</span> <span class="token keyword">await</span> valueLedger<span class="token punctuation">.</span><span class="token function">approveValue</span><span class="token punctuation">(</span><span class="token string">&quot;100000000000000000000&quot;</span><span class="token punctuation">,</span> transferProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> mutation<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Now we can sign the order, and then send the signature, as well as the order definition, through arbitrary channels to the account that will execute it.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> signature <span class="token operator">=</span> <span class="token keyword">await</span> gateway<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p>In this guide, we will switch to another MetaMask account to execute the order.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> mutation <span class="token operator">=</span> <span class="token keyword">await</span> gateway<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span>order<span class="token punctuation">,</span> signature<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> mutation<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If we did everything correctly, the atomic swap would perform successfully; otherwise, an error will be thrown, specifying what went wrong.</p> <h2 id="value-ledger-deploy-order"><a href="#value-ledger-deploy-order" class="header-anchor">#</a> Value ledger deploy order</h2> <div class="card custom-block"><p class="custom-block-title">Live example</p> <p>Click <a href="https://codesandbox.io/s/github/0xcert/example-value-ledger-deploy-order?module=%2FREADME.md" target="_self" rel="noopener noreferrer alternate">here</a> to check the live example for the value ledger deploy order.</p></div> <p>We always have two participants in a deploy order. The first is the maker of the order, the one who defines what will happen. The second one is the taker, who can either be directly specified or left empty to be filled by anyone who can execute the order. Our example will take the second option. So let's jump right in and define a deploy order.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> order <span class="token operator">=</span> <span class="token punctuation">{</span>
  kind<span class="token operator">:</span> OrderKind<span class="token punctuation">.</span><span class="token constant">VALUE_LEDGER_DEPLOY_ORDER</span><span class="token punctuation">,</span>
  makerId<span class="token operator">:</span> <span class="token string">'0x...'</span><span class="token punctuation">,</span> <span class="token comment">// account1 defining the order</span>
  seed<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// unique order identification</span>
  expiration<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">86400000</span><span class="token punctuation">,</span> <span class="token comment">// 1 day</span>
   valueLedgerData<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token comment">// ledger name</span>
    <span class="token builtin">symbol</span><span class="token operator">:</span> <span class="token string">&quot;TST&quot;</span><span class="token punctuation">,</span> <span class="token comment">// ledger symbol</span>
    supply<span class="token operator">:</span> <span class="token string">&quot;5000000000000000000000000&quot;</span><span class="token punctuation">,</span> <span class="token comment">// amount of tokens including the number of decimals, 500 mil in this case</span>
    decimals<span class="token operator">:</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">,</span> <span class="token comment">// amount of decimals</span>
    ownerId<span class="token operator">:</span> <span class="token string">'0x...'</span><span class="token punctuation">,</span> <span class="token comment">// account1 which will become the owner of the whole token supply</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  tokenTransferData<span class="token operator">:</span> <span class="token punctuation">{</span>
    ledgerId<span class="token operator">:</span> <span class="token string">'0x..'</span><span class="token punctuation">,</span> <span class="token comment">// valueLedgerId that we created in the previous guide</span>
    value<span class="token operator">:</span> <span class="token string">&quot;100000000000000000000&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 100 tokens</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">as</span> ValueLedgerDeployOrder<span class="token punctuation">;</span>
</code></pre></div><p>Since we are transferring some value, we also have to approve the <code>Gateway</code> for transferring it. We do this by calling approveValue upon the <code>ValueLedger</code> instance of the ledger we are transferring tokens from. We also need to specify the amount of value we are approving for transfer.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If we approve a huge amount of value (max is 2^256-1), we only need to approve it once per ledger, otherwise we would run out of allowance.</p></div> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> transferProxy <span class="token operator">=</span> <span class="token keyword">await</span> gateway<span class="token punctuation">.</span><span class="token function">getProxyAccountId</span><span class="token punctuation">(</span>ProxyKind<span class="token punctuation">.</span><span class="token constant">TRANSFER_TOKEN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mutation <span class="token operator">=</span> <span class="token keyword">await</span> valueLedger<span class="token punctuation">.</span><span class="token function">approveValue</span><span class="token punctuation">(</span><span class="token string">&quot;100000000000000000000&quot;</span><span class="token punctuation">,</span> transferProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> mutation<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Now we can sign the order, and then send the signature, as well as the order definition, through arbitrary channels to the account that will execute it.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> signature <span class="token operator">=</span> <span class="token keyword">await</span> gateway<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p>In this guide, we will switch to another MetaMask account to execute the order.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> mutation <span class="token operator">=</span> <span class="token keyword">await</span> gateway<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span>order<span class="token punctuation">,</span> signature<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> mutation<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If we did everything correctly, the atomic swap would perform successfully; Otherwise, an error will be thrown, specifying what went wrong.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/0xcert/docs/edit/master/framework/v2/guides/atomic-deployments.md" target="_blank" rel="noopener noreferrer">Help us improve this page.</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/24/2020, 2:26:33 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/framework/v2/guides/value-management.html" class="prev">
        Value management
      </a></span> <span class="next"><a href="/framework/v2/guides/atomic-actions.html">
        Atomic actions
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.beb59d9e.js" defer></script><script src="/assets/js/2.f199345b.js" defer></script><script src="/assets/js/7.ac8cad6a.js" defer></script><script src="/assets/js/61.f0466c96.js" defer></script><script src="/assets/js/5.36f6fd2c.js" defer></script>
  </body>
</html>
